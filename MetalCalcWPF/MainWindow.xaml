<Window x:Class="MetalCalcWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ†ÐµÑ…Ð¾Ð¼ (Laser Manager)" Height="650" Width="1000" WindowStartupLocation="CenterScreen">

    <Grid Margin="10">
        <Grid.Resources>
            <Style TargetType="TextBox">
                <Setter Property="Validation.ErrorTemplate">
                    <Setter.Value>
                        <ControlTemplate>
                            <DockPanel>
                                <Border BorderBrush="Red" BorderThickness="1">
                                    <AdornedElementPlaceholder/>
                                </Border>
                            </DockPanel>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="Validation.HasError" Value="true">
                        <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self}, Path=(Validation.Errors)[0].ErrorContent}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
        </Grid.Resources>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="380"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Border Grid.Column="0" BorderBrush="Gray" BorderThickness="1" CornerRadius="5" Padding="15" Margin="0,0,10,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,10">
                    <Button Content="ðŸ—„ï¸ Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…" Command="{Binding OpenDatabaseCommand}" Margin="0,0,5,0" Padding="5,2" Background="#FFF0F0F0"/>
                    <Button Content="âš™ ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸" Command="{Binding OpenSettingsCommand}" Padding="5,2"/>
                </StackPanel>

                <StackPanel Grid.Row="1" Margin="0,0,0,10">
                    <TextBlock Text="ÐšÐ»Ð¸ÐµÐ½Ñ‚ / ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð·Ð°ÐºÐ°Ð·Ð°:" FontWeight="Bold"/>
                    <TextBox Height="25" Margin="0,5,0,5" Text="{Binding ClientName, UpdateSourceTrigger=PropertyChanged}"/>

                    <TextBlock Text="ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»:" FontWeight="Bold" Margin="0,5,0,0"/>
                    <ComboBox Height="25" Margin="0,5,0,5"
                              ItemsSource="{Binding Materials}"
                              SelectedItem="{Binding SelectedMaterial}"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Margin="0,0,5,0">
                            <TextBlock Text="Ð¢Ð¾Ð»Ñ‰Ð¸Ð½Ð° (Ð¼Ð¼):" FontWeight="Bold"/>
                            <Grid Margin="0,5,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="40" />
                                </Grid.ColumnDefinitions>
                                <TextBox Height="25" Grid.Column="0" Text="{Binding ThicknessText, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"/>
                                <TextBlock Grid.Column="1" Text="Ð¼Ð¼" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Gray"/>
                            </Grid>
                        </StackPanel>
                        <StackPanel Grid.Column="1" Margin="5,0,0,0">
                            <TextBlock Text="ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ (ÑˆÑ‚):" FontWeight="Bold"/>
                            <Grid Margin="0,5,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="40" />
                                </Grid.ColumnDefinitions>
                                <TextBox Height="25" Grid.Column="0" Text="{Binding QuantityText, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"/>
                                <TextBlock Grid.Column="1" Text="ÑˆÑ‚" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Gray"/>
                            </Grid>
                        </StackPanel>
                    </Grid>

                    <TextBlock Text="Ð“Ð°Ð±Ð°Ñ€Ð¸Ñ‚Ñ‹ Ð¾Ð´Ð½Ð¾Ð¹ Ð´ÐµÑ‚Ð°Ð»Ð¸ (Ð¼Ð¼):" FontWeight="Bold" Margin="0,10,0,0"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="Ð¨Ð¸Ñ€Ð¸Ð½Ð° X:" FontSize="10" Foreground="Gray"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="40" />
                                </Grid.ColumnDefinitions>
                                <TextBox Height="25" Grid.Column="0" Text="{Binding WidthText, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"/>
                                <TextBlock Grid.Column="1" Text="Ð¼Ð¼" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Gray"/>
                            </Grid>
                        </StackPanel>

                        <TextBlock Grid.Column="1" Text="x" VerticalAlignment="Bottom" Margin="10,0,10,5" FontWeight="Bold"/>

                        <StackPanel Grid.Column="2">
                            <TextBlock Text="Ð’Ñ‹ÑÐ¾Ñ‚Ð° Y:" FontSize="10" Foreground="Gray"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="40" />
                                </Grid.ColumnDefinitions>
                                <TextBox Height="25" Grid.Column="0" Text="{Binding HeightText, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"/>
                                <TextBlock Grid.Column="1" Text="Ð¼Ð¼" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Gray"/>
                            </Grid>
                        </StackPanel>
                    </Grid>

                    <TextBlock Text="ÐœÐ°ÑÑÐ° (ÐºÐ³):" FontWeight="Bold" Margin="0,10,0,0"/>
                    <Grid Margin="0,5,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="40" />
                        </Grid.ColumnDefinitions>
                        <TextBox Height="25" Grid.Column="0" Text="{Binding WeightText, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"/>
                        <TextBlock Grid.Column="1" Text="ÐºÐ³" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Gray"/>
                    </Grid>
                    <TextBlock Text="Ð•ÑÐ»Ð¸ Ð¸Ð·Ð²ÐµÑÑ‚Ð½Ð° Ð¼Ð°ÑÑÐ° Ð¿Ð°Ñ€Ñ‚Ð¸Ð¸, ÑƒÐºÐ°Ð¶Ð¸Ñ‚Ðµ ÐµÑ‘ â€” Ð³Ð°Ð±Ð°Ñ€Ð¸Ñ‚Ñ‹ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¾ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿ÑƒÑÑ‚Ñ‹Ð¼Ð¸."
                               FontSize="10" Foreground="Gray" TextWrapping="Wrap"/>
                </StackPanel>

                <TabControl Grid.Row="2" Margin="0,0,0,10">
                    <TabItem Header="ðŸ”¥ Ð›Ð°Ð·ÐµÑ€">
                        <StackPanel Margin="10">
                            <TextBlock Text="Ð”Ð»Ð¸Ð½Ð° ÐºÐ¾Ð½Ñ‚ÑƒÑ€Ð°:"/>
                            <Grid Margin="0,5,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="40" />
                                </Grid.ColumnDefinitions>
                                <TextBox Height="25" Grid.Column="0" Text="{Binding LaserLengthText, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"/>
                                <TextBlock Grid.Column="1" Text="Ð¼" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Gray"/>
                            </Grid>
                            
                            <!-- âœ… ÐÐžÐ’ÐžÐ• ÐŸÐžÐ›Ð• -->
                            <TextBlock Text="ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾Ñ‚Ð²ÐµÑ€ÑÑ‚Ð¸Ð¹ (Ð¿Ñ€Ð¾Ð±Ð¸Ð²Ð¾Ðº):"/>
                            <Grid Margin="0,5,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="40" />
                                </Grid.ColumnDefinitions>
                                <TextBox Height="25" Grid.Column="0" Text="{Binding PiercesCountText, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"/>
                                <TextBlock Grid.Column="1" Text="ÑˆÑ‚" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Gray"/>
                            </Grid>
                            
                            <TextBlock Text="Ð”Ð»Ð¸Ð½Ð° Ñ€ÐµÐ·Ð° Ð¾Ð´Ð½Ð¾Ð¹ Ð´ÐµÑ‚Ð°Ð»Ð¸ + ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð¾Ð±Ð¸Ð²Ð¾Ðº Ð²Ð»Ð¸ÑÑŽÑ‚ Ð½Ð° ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ" 
                                       FontSize="10" Foreground="Gray" TextWrapping="Wrap"/>
                        </StackPanel>
                    </TabItem>

                    <TabItem Header="ðŸ“ Ð“Ð¸Ð±ÐºÐ°">
                        <StackPanel Margin="10">
                            <CheckBox Content="Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ Ð³Ð¸Ð±ÐºÑƒ Ð² Ñ€Ð°ÑÑ‡ÐµÑ‚Ðµ" IsChecked="{Binding UseBending}" FontWeight="Bold" Margin="0,0,0,10"/>

                            <TextBlock Text="ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð³Ð¸Ð±Ð¾Ð² (Ð½Ð° 1 Ð´ÐµÑ‚Ð°Ð»ÑŒ):"/>
                            <Grid Margin="0,5,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="40" />
                                </Grid.ColumnDefinitions>
                                <TextBox Height="25" Grid.Column="0" Text="{Binding BendsCountText, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"/>
                                <TextBlock Grid.Column="1" Text="ÑˆÑ‚" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Gray"/>
                            </Grid>

                            <TextBlock Text="Ð”Ð»Ð¸Ð½Ð° Ð»Ð¸Ð½Ð¸Ð¸ Ð³Ð¸Ð±Ð°:"/>
                            <Grid Margin="0,5,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="40" />
                                </Grid.ColumnDefinitions>
                                <TextBox Height="25" Grid.Column="0" Text="{Binding BendLengthText, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"/>
                                <TextBlock Grid.Column="1" Text="Ð¼Ð¼" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Gray"/>
                            </Grid>
                            <TextBlock Text="Ð’Ð»Ð¸ÑÐµÑ‚ Ð½Ð° ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ (Ð´Ð¾ 1.5Ð¼ / Ð´Ð¾ 3Ð¼ / Ð´Ð¾ 6Ð¼)" FontSize="10" Foreground="Gray" Margin="0,-5,0,10"/>

                            <Border BorderBrush="Gray" BorderThickness="1" CornerRadius="3" Padding="5" Background="#F0F0F0" Margin="0,10,0,0">
                                <StackPanel>
                                    <TextBlock Text="Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ:" FontWeight="Bold" FontSize="10"/>
                                    <TextBlock Text="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ‚Ð¾Ð»Ñ‰Ð¸Ð½Ñƒ..." FontSize="11" Foreground="Blue"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </TabItem>

                    <TabItem Header="ðŸ—ï¸ Ð¡Ð²Ð°Ñ€ÐºÐ°">
                        <StackPanel Margin="10">
                            <TextBlock Text="Ð”Ð»Ð¸Ð½Ð° ÑˆÐ²Ð°:"/>
                            <Grid Margin="0,5,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="40" />
                                </Grid.ColumnDefinitions>
                                <TextBox Height="25" Grid.Column="0" Text="{Binding WeldLengthText, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"/>
                                <TextBlock Grid.Column="1" Text="ÑÐ¼" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Gray"/>
                            </Grid>
                            <CheckBox Content="Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ ÑÐ²Ð°Ñ€ÐºÑƒ" IsChecked="{Binding UseWelding}" FontWeight="Bold"/>
                        </StackPanel>
                    </TabItem>
                </TabControl>

                <StackPanel Grid.Row="3">
                    <Button Content="Ð Ð°ÑÑÑ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ Ð²ÑÑ‘" Height="45" Command="{Binding CalculateCommand}" Background="#4CAF50" Foreground="White" FontSize="14" FontWeight="Bold"/>
                    <TextBlock Text="{Binding ResultText}" FontSize="26" FontWeight="Bold" Margin="0,15,0,0" Foreground="#2E7D32" HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding ResultDetails}" FontSize="11" Foreground="Gray" TextWrapping="Wrap" Margin="0,5,0,0"/>
                    <TextBlock Text="{Binding ValidationMessage}" FontSize="12" Foreground="DarkRed" TextWrapping="Wrap" Margin="0,8,0,0" HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <GroupBox Grid.Column="1" Header="Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð¾Ð²" Margin="0,0,0,10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Button Grid.Row="0" Content="ðŸ“Š Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ Ð² Excel" HorizontalAlignment="Right"
                        Width="120" Height="25" Margin="0,5,5,5"
                        Command="{Binding ExportToExcelCommand}" Background="#E0F7FA"/>

                <DataGrid Grid.Row="1" ItemsSource="{Binding History}" SelectedItem="{Binding SelectedHistory}"
                          AutoGenerateColumns="False" IsReadOnly="True" CanUserAddRows="False">
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <!-- ContextMenu Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð²Ð½Ðµ Ð»Ð¾Ð³Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð´ÐµÑ€ÐµÐ²Ð°, Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ PlacementTarget.
                                 ÐŸÐµÑ€ÐµÐ´Ð°Ñ‘Ð¼ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ ÐºÐ°Ðº Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ -->
                            <MenuItem Header="ðŸ—‘ Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÑ‚Ñ€Ð¾ÐºÑƒ"
                                      Command="{Binding PlacementTarget.DataContext.DeleteOrderByParamCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                      CommandParameter="{Binding PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="â„–" Binding="{Binding Id}" Width="30"/>
                        <DataGridTextColumn Header="Ð”Ð°Ñ‚Ð°" Binding="{Binding CreatedDate, StringFormat=\{0:dd.MM HH:mm\}}" Width="90"/>
                        <DataGridTextColumn Header="Ð¢Ð¸Ð¿" Binding="{Binding OperationType}" Width="60" FontWeight="Bold"/>
                        <DataGridTextColumn Header="ÐšÐ»Ð¸ÐµÐ½Ñ‚" Binding="{Binding ClientName}" Width="*"/>
                        <DataGridTextColumn Header="Ð˜Ð½Ñ„Ð¾" Binding="{Binding Description}" Width="100"/>
                        <DataGridTextColumn Header="Ð¡ÑƒÐ¼Ð¼Ð°" Binding="{Binding TotalPrice, StringFormat=\{0:N0\} â‚¸}" Width="70" FontWeight="Bold"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </GroupBox>
    </Grid>
</Window>
